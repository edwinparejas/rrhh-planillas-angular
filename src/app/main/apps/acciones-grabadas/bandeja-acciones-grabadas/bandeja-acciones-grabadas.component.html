<div class="page-layout carded fullwidth inner-scroll p-16" mineduPerfectScrollbar>
    <div class="page-layout carded left-sidebar inner-scroll">
        <div class="center">
            <div class="ml-6 mr-8" fxLayout="row" fxLayoutAlign="space-between center">
                <h3>Acciones grabadas</h3>
                <span fxLayout="row">
                    <ol class="breadcrumb pull-right">
                        <li><a [routerLink]="['/ayni/personal/inicio']"><mat-icon color="accent" class="s-18">home</mat-icon> Inicio</a></li>       
                        <li class="active"><a [routerLink]="['/ayni/personal/inicio/accionesgrabadas']">Acciones Grabadas</a></li>    
                    </ol>
                     
                </span>
            </div>
            <div fxLayout="row">
                <div class="content" mineduPerfectScrollbar>
                    <div fxLayout="column">
                        <minedu-criterios-busqueda-acciones-grabadas #criteriosBusqueda (mineduOnClick)="buscar($event)" 
                        [currentSession]="currentSession"
                        [working]="working">
                        </minedu-criterios-busqueda-acciones-grabadas>
                        <div fxLayout="row" fxLayoutAlign="end center" class="mb-10">
                            <div class="pl-6" fxLayout="row">
                                <button mat-raised-button color="primary"
                                    (click)="handleModalGenerarProyectoResolucionMasivo()" *ngIf="Acceso.GENERAR_PROYECTO_MASIVO"
                                    [@animate]="{value:'*', params:{delay:'300ms',scale:'.2'}}">
                                    <span class="material-icons">add_circle_outline</span>
                                    GENERAR PROYECTO MASIVO
                                </button>
                            </div>
                            <div>
                                <div class="pl-6" fxLayout="row">
                                    <button mat-stroked-button color="primary"
                                        [@animate]="{value:'*', params:{delay:'300ms',scale:'.2'}}"
                                        (click)="exportar()" [disabled]="export"><span class="material-icons">get_app</span>
                                        Exportar
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="content-table" ngClass.lt-lg="scroll-grid" style="overflow: auto;">
                            <table mat-table class="minedu-table" #table [dataSource]="dataSource" [@animateStagger]="{value:'50'}">

                                <ng-container matColumnDef="seleccione">
                                    <th mat-header-cell *matHeaderCellDef>
                                        <mat-checkbox (change)="$event ? masterToggle() : null"
                                            [checked]="selection.hasValue() && isAllSelected()"
                                            [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                                        </mat-checkbox>
                                    </th>
                                    <td mat-cell *matCellDef="let row; let i = indice;">
                                        <mat-checkbox [checked]="selection.isSelected(row)" (click)="$event.stopPropagation()"
                                            (change)="$event ? selection.toggle(row) : null" [aria-label]="checkboxLabel(row)">
                                        </mat-checkbox>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="regimenLaboralDes">
                                    <th mat-header-cell *matHeaderCellDef>R&eacute;gimen laboral</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.regimenLaboralDes">{{row.regimenLaboralDes}}</p>
                                        <p *ngIf="!row.regimenLaboralDes">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="grupoAccion">
                                    <th mat-header-cell *matHeaderCellDef>Grupo acci&oacute;n</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.grupoAccion">{{row.grupoAccion}}</p>
                                        <p *ngIf="!row.grupoAccion">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="accion">
                                    <th mat-header-cell *matHeaderCellDef>Acci&oacute;n</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.accion">{{row.accion}}</p>
                                        <p *ngIf="!row.accion">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="motivoAccion">
                                    <th mat-header-cell *matHeaderCellDef>Motivo acci&oacute;n</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.motivoAccion">{{row.motivoAccion}}</p>
                                        <p *ngIf="!row.motivoAccion">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="esMandatoJudicial">
                                    <th mat-header-cell *matHeaderCellDef>Mandato judicial</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.esMandatoJudicial">SI</p>
                                        <p *ngIf="!row.esMandatoJudicial">NO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="codigoPlaza">
                                    <th mat-header-cell *matHeaderCellDef>C&oacute;digo de plaza</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.codigoPlaza">{{row.codigoPlaza}}</p>
                                        <p *ngIf="!row.codigoPlaza">NO REGISTRADO</p>
                                    </td>
                                </ng-container> -->

                                <ng-container matColumnDef="documento">
                                    <th mat-header-cell *matHeaderCellDef>Documento</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.documento">{{row.documento}}</p>
                                        <p *ngIf="!row.documento">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="apellidosYNombres">
                                    <th mat-header-cell *matHeaderCellDef>Apellidos y nombres</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.apellidosYNombres">{{row.apellidosYNombres}}</p>
                                        <p *ngIf="!row.apellidosYNombres">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="fechaInicio">
                                    <th mat-header-cell *matHeaderCellDef>Fecha inicio</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.fechaInicio">{{row.fechaInicio  | date:'dd/MM/yyyy'}}</p>
                                        <p *ngIf="!row.fechaInicio">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="fechaFin">
                                    <th mat-header-cell *matHeaderCellDef>Fecha fin</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.fechaFin">{{row.fechaFin | date:'dd/MM/yyyy'}}</p>
                                        <p *ngIf="!row.fechaFin">NO REGISTRADO</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="codigoEstadoAccionGrabada">
                                    <th mat-header-cell *matHeaderCellDef>Estado</th>
                                    <td mat-cell *matCellDef="let row">
                                        <p *ngIf="row.codigoEstadoAccionGrabada==6" class="h7 p-4"
                                            [ngClass]="{'orange-500':row.codigoEstadoAccionGrabada == 6 }"> {{row.descripcionEstadoAccionGrabada}}</p>
                                        <p *ngIf="row.codigoEstadoAccionGrabada==1" class="h7 p-4"
                                            [ngClass]="{'orange-500':row.codigoEstadoAccionGrabada == 1 }"> {{row.descripcionEstadoAccionGrabada}}</p>
                                        <p *ngIf="row.codigoEstadoAccionGrabada==2" class="h7 p-4"
                                            [ngClass]="{'cyan-600':row.codigoEstadoAccionGrabada == 2 }"> {{row.descripcionEstadoAccionGrabada}}</p>
                                        <p *ngIf="row.codigoEstadoAccionGrabada==3" class="h7 p-4"
                                            [ngClass]="{'green-600':row.codigoEstadoAccionGrabada == 3 }"> {{row.descripcionEstadoAccionGrabada}}</p>
                                        <p *ngIf="row.codigoEstadoAccionGrabada==4" class="h7 p-4"
                                            [ngClass]="{'red-600':row.codigoEstadoAccionGrabada == 4 }"> {{row.descripcionEstadoAccionGrabada}}</p>
                                        <p *ngIf="row.codigoEstadoAccionGrabada==5" class="h7 p-4"
                                            [ngClass]="{'green-600':row.codigoEstadoAccionGrabada == 5 }"> {{row.descripcionEstadoAccionGrabada}}/p>

                                        <p *ngIf="!row.codigoEstadoAccionGrabada">N/A</p>
                                    </td>
                                </ng-container>

                                <ng-container matColumnDef="acciones">
                                    <th mat-header-cell *matHeaderCellDef>Acciones</th>
                                    <td mat-cell *matCellDef="let row; let  i = indice;">
                                        <div fxLayout="row" fxLayoutAlign="start center">
                                            <div class="mat-icon-table">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="handleVistaProyecto(row)"
                                                    aria-label="Ver información"
                                                    matTooltip="Ver información" >
                                                    <mat-icon class="">info</mat-icon>
                                                </button>
                                            </div>
                                            <div class="mat-icon-table"
                                                *ngIf="row.codigoEstadoAccionGrabada==estadoPendienteDeProyecto && 
                                                    Acceso.GENERAR_PROYECTO_INDIVIDUAL">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="handleModalGenerarProyectoResolucionIndividual(row)"
                                                    aria-label="Generar proyecto resolución"
                                                    matTooltip="Generar proyecto resolución">
                                                    <mat-icon class="">settings</mat-icon>
                                                </button>
                                            </div>
                                            <div class="mat-icon-table"
                                                *ngIf="row.codigoEstadoAccionGrabada==estadoPendienteDeProyecto &&
                                                    Acceso.ELIMINAR_ACCION_GRABADA">
                                                <button mat-stroked-button color="warn" class="sidebar-toggle btn-sm"
                                                    (click)="mostrarModalEliminarAccionGrabada(row)" aria-label="Eliminar"
                                                    matTooltip="Eliminar">
                                                    <mat-icon class="">delete_forever</mat-icon>
                                                </button>
                                            </div>      
                                            <!-- <div class="mat-icon-table"
                                                *ngIf="row.codigoEstadoAccionGrabada==estadoCreandoProyecto">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="validDownload(row)" aria-label="Ver proyecto resolución"
                                                    matTooltip="Ver proyecto resolución">
                                                    <mat-icon class="">description</mat-icon>
                                                </button>
                                            </div>     -->
                                            <div class="mat-icon-table" 
                                                *ngIf="row.codigoEstadoAccionGrabada==estadoEnProyecto || 
                                                    row.codigoEstadoAccionGrabada==estadoConResolucion ||
                                                    row.codigoEstadoAccionGrabada==estadoCreandoProyecto">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="validDownload(row)" aria-label="Ver proyecto resolución"
                                                    matTooltip="Ver proyecto resolución">
                                                    <mat-icon class="">description</mat-icon>
                                                </button>
                                                <!-- <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="validDownload(row)" aria-label="Ver proyecto resolución validDownload.." matTooltip="VISUALIZAR documento PDF">
                                                    <mat-icon class="">picture_as_pdf</mat-icon>
                                                </button> -->
                                            </div>       
                                            <div class="mat-icon-table" *ngIf="row.codigoEstadoAccionGrabada==estadoEliminado">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="validMotivoEliminacion(row)" aria-label="Ver Motivo"
                                                    matTooltip="Ver Motivo">
                                                    <mat-icon class="">visibility</mat-icon>
                                                </button>
                                            </div>   
                                            <div class="mat-icon-table" *ngIf="row.comentarioError">
                                                <span class="material-icons" matTooltip="{{ toolTipErrorProyectoResolucion }}"
                                                    style="cursor: help;">warning_amber</span>
                                                <!-- <mat-icon class="" matTooltip="{{row.comentarioError}}" style="cursor: help;">warning_amber</mat-icon> -->
                                            </div>

                                            <!-- <div class="mat-icon-table" *ngIf="row.codigoEstadoAccionGrabada==estadoConResolucion">
                                                <button mat-stroked-button color="primary" class="sidebar-toggle btn-sm"
                                                    (click)="validDownload(row)" aria-label="Ver proyecto resolución"
                                                    matTooltip="Ver proyecto resolución">
                                                    <mat-icon class="">description</mat-icon>
                                                </button>
                                            </div> -->
                                        </div>
                                    </td>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="displayedColumns; "></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selection.toggle(row)"
                                    [ngClass]="{hovered: row.hovered, selected: selection.isSelected(row)}"
                                    (mouseover)="row.hovered = true" (mouseout)="row.hovered = false"
                                    [@animate]="{value:'*',params:{y:'100%'}}">
                                </tr>
                            </table>


                            <div class="no-results" *ngIf="!(dataSource.loading | async)"
                                [style.display]="dataSource.data.length === 0 ? '' : 'none'">
                                No se encontraron registros
                            </div>
                            <div fxLayout="column" fxLayoutAlign="center center" class="spinner-container"
                                *ngIf="dataSource.loading | async">
                                <mat-spinner diameter="50"></mat-spinner>
                            </div>
                        </div>
                        
                        <mat-paginator #paginator class="mat-paginator-sticky" [length]="dataSource.dataTotal" 
                        fxLayoutAlign="center center"
                        [pageIndex]="paginatorPageIndex"
                        [pageSize]="paginatorPageSize" 
                        [pageSizeOptions]="[5, 10, 20, 30, 40, 50, 100]" showFirstLastButtons></mat-paginator>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
